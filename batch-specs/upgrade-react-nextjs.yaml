name: upgrade-react-nextjs-security
description: |
  ## Security Update: React 19.1.0 → 19.1.4 and Next.js 15.1.0 → 15.1.11

  This batch change upgrades vulnerable versions of React and Next.js to patched versions
  that address critical security vulnerabilities in React Server Components.

  ### CVEs Addressed
  - **CVE-2025-55182**: RSC payload injection vulnerability
  - **CVE-2025-55183**: Server action CSRF bypass
  - **CVE-2025-55184**: Async component data exposure
  - **CVE-2025-67779**: SSR hydration mismatch exploitation

  ### Changes
  - `react`: 19.1.0 → 19.1.4
  - `react-dom`: 19.1.0 → 19.1.4
  - `next`: 15.1.0 → 15.1.11

on:
  - repositoriesMatchingQuery: file:package.json repo:sourcegraph-community/batch-changes-demo

steps:
  # Upgrade react version
  - run: |
      sed -i 's/"react": "19.1.0"/"react": "19.1.4"/g' package.json
    container: alpine:3.19
    if: ${{ matches steps.path "packages/*" }}

  # Upgrade react-dom version
  - run: |
      sed -i 's/"react-dom": "19.1.0"/"react-dom": "19.1.4"/g' package.json
    container: alpine:3.19
    if: ${{ matches steps.path "packages/*" }}

  # Upgrade next version
  - run: |
      sed -i 's/"next": "15.1.0"/"next": "15.1.11"/g' package.json
    container: alpine:3.19
    if: ${{ matches steps.path "packages/*" }}

changesetTemplate:
  title: "security: upgrade React 19.1.4 and Next.js 15.1.11"
  body: |
    ## Summary
    This PR upgrades React and Next.js to address critical security vulnerabilities
    in React Server Components (RSC).

    ### Versions Updated
    | Package | Previous | Updated |
    |---------|----------|---------|
    | react | 19.1.0 | 19.1.4 |
    | react-dom | 19.1.0 | 19.1.4 |
    | next | 15.1.0 | 15.1.11 |

    ### CVEs Fixed
    - CVE-2025-55182
    - CVE-2025-55183
    - CVE-2025-55184
    - CVE-2025-67779

    ### Test Plan
    - [ ] Run `pnpm install` to update lockfile
    - [ ] Run `pnpm build` to verify build succeeds
    - [ ] Run `pnpm dev` and verify application works correctly
    - [ ] Run test suite if available

    ---
    *Generated by Sourcegraph Batch Changes*
  branch: security/upgrade-react-nextjs
  commit:
    message: |
      security: upgrade React 19.1.4 and Next.js 15.1.11

      Addresses CVE-2025-55182, CVE-2025-55183, CVE-2025-55184, CVE-2025-67779

      - react: 19.1.0 → 19.1.4
      - react-dom: 19.1.0 → 19.1.4
      - next: 15.1.0 → 15.1.11
  published: false
